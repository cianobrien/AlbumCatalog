<% if notice %>
  <p id="notice"><%= notice %></p>
<% end %>

<p>
  <h1><%= @profile.name %></h1>
</p>

<% if session[:user_id] %>
<% if @profile == User.find(session[:user_id]).profile %>
  <p class = links>
    <%= link_to 'Edit Profile', edit_profile_path(@profile) %>
  </p>
<% else %>
  <% if User.find(session[:user_id]).following?(@profile) %>
    <p class = links><%= link_to 'Following', @profile.find_followship(User.find(session[:user_id])), :method => :delete %>
  <% else %></p>
    <p class = links><%= link_to 'Follow', followships_path(profile_id: @profile), :method => :post %></p>
  <% end %>
<% end %>
<% end %>

<table>

  <td>
  <% if @profile.profile_picture_url == nil  %>
      <%= image_tag("https://upload.wikimedia.org/wikipedia/commons/0/0e/Lakeyboy_Silhouette.PNG", size: "150x200", class: 'list_image') %>
  <% else %>
    <%= image_tag(@profile.profile_picture_url, size: "150x200", class: 'list_image') %>
  <% end %>
  <br>
  Followers: <% @profile.num_followers %>
  </td>

<td class='bio'>
	  <dl>
	    <pre>
	      <h2>Bio:</h2>
	      <%= @profile.bio %>
	    </pre>
	  </dl>
	</td>
</table>


<br>
<br>

<% if session[:user_id] %>
<% if @profile == User.find(session[:user_id]).profile %>
  <center><h2>Your Album List:</h2></center>
<% end %>
<% else %>
  <% if @profile.name == nil  %>
    <center><h2>New User's Album List:</h2></center>
  <% else %>
    <center><h2><%= @profile.name %>'s Album List:</h2></center>
  <% end %>
<% end %>


<br>
<br>
<br>
<br>
   
<% @profile.line_items.order(:rating).reverse.each do |line_item| %>
  <span class = "cover"><%= link_to image_tag(line_item.album.image_url, size: "150x150", class: 'list_image'), line_item %>
    <span class="imgDescription">
      <% if line_item.rating > 0 %>
	<%= line_item.album.artist %>:<br><%= line_item.album.name %> (<%= line_item.rating.round(1) %>)
      <% else %>
	<%= line_item.album.artist %>:<br><%= line_item.album.name %>
      <% end %>
    </span>
    <% if session[:user_id] %>
    <% if @profile == User.find(session[:user_id]).profile %>
      <span class="imglink"><%= link_to 'Remove from Profile', line_item, method: :delete %></span>
    <% end %>
    <% end %>
  </span>
<% end %>

<br>
<br>
<% if session[:user_id] %>
<% if @profile == User.find(session[:user_id]).profile %>
  <%= link_to 'Delete your account', User.find(session[:user_id]), method: :delete, data: { confirm: 'Are you sure?' } %>
<% end %>
<% end %>


